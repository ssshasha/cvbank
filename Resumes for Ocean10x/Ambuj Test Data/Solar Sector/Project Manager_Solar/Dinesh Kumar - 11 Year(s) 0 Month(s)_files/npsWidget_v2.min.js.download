function isDOMElement(a){try{return a instanceof HTMLElement}catch(b){return"object"===(void 0===a?"undefined":_typeof(a))&&1===a.nodeType&&"object"===_typeof(a.style)&&"object"===_typeof(a.ownerDocument)}}function saveCommentData(a,b){return commentData.element=a,commentData.value=b,commentData}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),defineProperty=function(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a},_extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},inherits=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)},possibleConstructorReturn=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b},commentData={};window.tagAjax||(window.tagAjax={}),window.tagAjax.saveCommentData=saveCommentData;var Components=function(){function a(b,c){classCallCheck(this,a),this.node=b?this.getNode(b):"",this.parent=c?this.getNode(c):""}return createClass(a,[{key:"getNode",value:function(a){return a instanceof jQuery?a:"string"==typeof a||isDOMElement(a)?$(a):null}},{key:"render",value:function(){if(!this.node)return null;var a=this.getHTML();this.node.html(a)}},{key:"update",value:function(a){this.data=_extends({},this.data,a),this.render()}}]),a}(),NpsWidget=function(a){function b(a){classCallCheck(this,b);var c=possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a.node));return c.lightbox_instance=a.lightbox_instance,c.init(),c}return inherits(b,a),createClass(b,[{key:"init",value:function(){rdxCache.getItem("nps_"+userId)||this.node.fadeIn(),this.questionJson={type1:{question:{QUES_CHANGES_FOR_HIGH_RATING:"What changes we need to make to get a higher rating from you?"},answers:{SEARCH:"Searching candidates should be made more simple in Resdex",SEARCH_LOGIC:"Search Logic should be improved to fetch more relevant candidates",RESPONSES:"More targeting options in Resdex Emails flow to fetch more applies from mailers"},ratingId:5},type2:{question:{QUES_CHANGES_FOR_HIGH_RATING:"What is working well in Resdex?"},answers:{SEARCH:"Searching and managing candidates is easy",SEARCH_LOGIC:"Getting relevant candidates for my requirements, able to close positions easily",RESPONSES:"Getting enough responses from Resdex Emails."},ratingId:9}},this.bindEvents()}},{key:"bindEvents",value:function(){var a=this,b=this.node;b.on("click",".ratingScale span",function(c){var d=$(c.target).attr("data-val");b.hide(),d<6||d>=8?a.showNPSQuestionLightbox(d):a.sendUBA(d)}),b.on("click",".npsCross",function(c){b.hide(),a.setLocalstorage()})}},{key:"showNPSQuestionLightbox",value:function(a){var b=this,c=a<6?this.questionJson.type1:this.questionJson.type2;c.rating=a;var d=this.getQuestionHTML(c),e=this.lightbox_instance.options.ltBox,f=e.find(".ltCntnt");this.lightbox_body=f,e.find(".ltGlobalTtl").html("Tell us what you think?"),f.html(d),this.lightbox_instance.open(),this.lightbox_instance.options.close.success=function(){var a=b.lightbox_body;a.find("#send_feed").hasClass("clicked")||b.sendUBA(a.find("#nps_rating").val())},this.attachQuestionEvent(f)}},{key:"getQuestionHTML",value:function(a){return'<form class="NPSfeedbackForm" id="NPSForm">\n              <input type="hidden" name="rating" value="'+a.rating+'" id="nps_rating" />\n                      '+this.getQuesHtml(a)+'\n                      <div class="quesContainer">\n                        '+this.getAnsOptionHtml(a)+'\n                      </div>\n                    <div class="feedbackSection">\n                      <p class="heading">Any other feedback</p>\n                      <textarea class="longInput feedbackTxt" cols="30" rows="4" maxlength="250" name="feed_txt"></textarea>\n                  </div>\n                  <span class="ErrorNPS">Choose a feedback before submit</span>\n                  <div class="btnWrapper">\n                      <span class="sendFeedback btn btn-primary feedBackbtn" id="send_feed">Submit Feedback</span>\n                  </div>\n               </form>'}},{key:"getAnsOptionHtml",value:function(a){var b=Object.keys(a.answers);return b.map(function(b,c){return'<div class="quesNPS">    \n                     <input type="checkbox" class="nps-checkbox" name="'+b+'" value="'+a.answers[b]+'" id="'+b+'">      \n                     <label for="'+b+'">    \n                        <span></span> <em class="lblAnchor">'+a.answers[b]+"</em>  \n                     </label> \n                  </div>"}).join("")}},{key:"getQuesHtml",value:function(a){var b=Object.keys(a.question);return'<input type="hidden" class="ratingId" value="'+a.ratingId+'" ><p class="heading" id="questionHeading" data-lable="'+b+'">'+a.question[b]+"</p>"}},{key:"attachQuestionEvent",value:function(a){var b=this,a=a;a.on("click",".feedBackbtn",function(c){var d=b.getAnsSelectedFromNPSform(),e=b.getFeedbackTxt(),f=a.find("#nps_rating").val(),g=a.find("#questionHeading").text();d.length||e?(b.sendUBA(f,{question:g,answer:d},e),a.find("#send_feed").addClass("clicked"),b.lightbox_instance.close()):$(".ErrorNPS").show()})}},{key:"sendUBA",value:function(a,b,c){try{ub.track("npsRating",defineProperty({actionType:"click",recruiterId:userId,pageName:pageName,rating:parseInt(a),questionOne:b?{q:b.question,a:b.answer,others:""}:{},questionTwo:c?{q:"Feedback",a:"",others:c}:{}},"pageName",pageName))}catch(a){}this.setLocalstorage(1)}},{key:"getFeedbackTxt",value:function(){var a=this.lightbox_body;return $.trim(a.find(".feedbackTxt").val())}},{key:"getAnsSelectedFromNPSform",value:function(){var a=this.lightbox_body;return a.find(".nps-checkbox:checked").map(function(){return $(this).val()}).get().join(",")}},{key:"setLocalstorage",value:function(a){var a=a||0,b=new Date,c=null;if(1==a){var d,e=b.getMonth();e<3?d=1:e<6?d=2:e<9?d=3:e<12&&(d=4),c=new Date(b.getFullYear(),3*d,1)}else c=new Date(b.setDate(b.getDate()+7));rdxCache.setItem("nps_"+userId,1,c?{expirationAbsolute:c}:null)}},{key:"getScaleHtml",value:function(){return'<span class="low" data-val="0">0</span><span class="low" data-val="1">1</span><span class="low" data-val="2">2</span><span class="low" data-val="3">3</span><span class="low" data-val="4">4</span><span class="low" data-val="5">5</span><span class="low" data-val="6">6</span><span class="medium" data-val="7">7</span><span class="medium" data-val="8">8</span><span class="high" data-val="9">9</span><span class="high" data-val="10">10</span>'}},{key:"getHTML",value:function(){return'<div class="cont">\n              <em class="npsCross">&#10005;</em>\n               <p class="heading">How Likely is it that you would recommend Resdex to your Friend or Colleague?</p>\n               <div class="quesContainer">\n                  <div class="scaleIndicator">\n                     <span>Very Unlikely</span>\n                     <span>Very Likely</span>\n                  </div>\n                  <div class="ratingScale">\n                      '+this.getScaleHtml()+"\n                  </div>\n               </div>\n            </div>"}}]),b}(Components);$(window).on("load",function(){var a=(rdxCache.getItem("cvView")||0)+1;rdxCache.setItem("cvView",a),a>2&&!rdxCache.getItem("nps_"+userId)&&setTimeout(function(){new NpsWidget({node:$("#cvNpsBand"),lightbox_instance:addLB}).render()},3e4)});