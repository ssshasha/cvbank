function getHiringForInfo(a,b,c){return a=baseAPIUrl+"/resdex/v1/"+a,createPromise(a,_extends({},commonOptions,{data:{getCompanyHFList:"preview"===b?0:1,showComments:"preview"===b?1:0,commentsOnHF:1,byMe:"preview"===b?0:1}}),"get",c)}function createPromise(a,b,c,d){return new Promise(function(e,f){_api(a,b,d,function(a,b,c){e({data:a,textStatus:b,xhr:c})},function(a,b,c){f({error:a,textStatus:b,xhr:c})})[c]()})}function saveCommentData(a,b){return commentData.element=a,commentData.value=b,commentData}function getDDListObjects(){return ddObjects}function showSelectedDD(a){var b=a&&a.attr("id"),c=$(".prefillData");switch(c.css("display","block"),$("#srpSticky").addClass("prefillAdd"),b){case"notInterested-dd":c.find(".lb-notinterested label").html("Not Interested"),a.addClass("selected");break;case"inprocess-dd":c.find(".lb-status label").html("Status"),a.addClass("selected");break;case"communication-dd":c.find(".lb-comm label").html("Communication"),a.addClass("selected");break;case"contactibility-dd":c.find(".lb-contactibility label").html("Contactibility"),a.addClass("selected")}a.parents(".ddHeading").addClass("hideDDLabel")}function create_sugg_user_data(a){var b=[];for(var c in a)b.push({displayTextEn:a[c]});return b}function getKeyFromValue(a,b){var c=void 0;for(var d in a)if(a[d].toLowerCase()==b.toLowerCase()){c=d;break}return c}function updateReadAllCount(a){var b=$("#openCommLayer");a<=5?b.hide():b.show(),b.find(".count").text(a),$("#recentCommCount").find(".count").text(a>5?5:a),b.parents(".stickyCv").length&&(a>0?b.show():b.hide())}var classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),defineProperty=function(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a},_extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},TrackingEvents=function(){function a(){classCallCheck(this,a)}return createClass(a,null,[{key:"getTrackingEvents",value:function(){return{cvPreviewClick:{searchId:"undefined"!=typeof sid?sid:"",cvId:"undefined"!=typeof uniqId?uniqId:"",recName:"undefined"!=typeof gnb_variables?gnb_variables.recruiterUsername:"",ind:$(".indInfo").text(),fa:$(".faInfo").text(),exp:$(".expInfo").text(),sal:$(".salInfo").text(),email:$.trim($(".email").text()).split(" ")[0],cvName:$(".userName").text(),lastActive:$(".lastActInfo").text().split(":")[1],currLocation:$(".locInfo").text()},hfClick:{suggestionsRequested:!1,suggestionsSelected:!1},resdexSrpClick:{hfKeyword:hfStateData?hfStateData.name:null,hfType:hfStateData&&hfStateData.id?"Selected":"created",searchId:searchData.sid}}}}]),a}(),RecTracking=function(){function a(){classCallCheck(this,a)}return createClass(a,null,[{key:"track",value:function(a,b){var c={actionType:"click",recruiterId:userId,companyId:companyId,pageName:pageName},d=_extends({},c,TrackingEvents.getTrackingEvents()[a],b);try{ub.track(a,d)}catch(a){}}}]),a}(),ResdexEvents=function(){function a(){classCallCheck(this,a)}return createClass(a,null,[{key:"dispatchEvent",value:function(a,b,c){document.createEvent("Event").initEvent(a,!0,!0),b.trigger(a,[c])}}]),a}(),commonOptions={contentType:"application/json",headers:{Accept:"application/json",clientId:"desktop"}},_api=function(a,b,c,d,e){var f={beforeSend:function(){$("#"+c).gLoader().block()},complete:function(){$("#"+c).gLoader().unblock()},success:function(a,b,e){$("#"+c).gLoader().unblock(),d(a,b,e)},error:function(a,b,d){$("#"+c).gLoader().unblock(),e(a,b,d)}};return f=_extends(f,b),{post:function(){$.ajax(a,_extends({},f,{type:"POST"}))},get:function(){$.ajax(a,_extends({},f,{type:"GET"}))}}};window.tagAjax||(window.tagAjax={}),window.tagAjax.getHiringForInfo=getHiringForInfo;var commentData={},ddObjects={};window.tagAjax||(window.tagAjax={}),window.tagAjax.saveCommentData=saveCommentData,"hfdp"==pageName&&(hfStateData=hiringForDetails);var sugg_hash_data=[],sugg_user_data=create_sugg_user_data(userList),commentsLayer=function(a){var b,c,d=suggestor_iife,e=d.suggestor,f={autoComplete:"//suggest.naukri.com/suggest/autosuggest?",relatedConcept:"//suggest.naukri.com/suggest/autoconcepts?",checkVersion:"//suggest.naukri.com/suggest/v?",prefetch:"//suggest.naukri.com/suggest/prefetch?"},g={1:"Tags",0:"Tags and comments"},h=a.comment_layer_div,j=void 0,k=a.layer_click_btn,l=new RegExp(/\s@([a-zA-Z0-9._@-]*)/g),m=baseAPIUrl+"/resdex/v2/jsprofile",n={},o=pageName.toLowerCase(),p=(a.bindClick_div,void 0===a.showDrawer||a.showDrawer),q=a.hiringForJson||window.hfCompanyList||{},r={"candidate not interested":"candidate not interested #Not_Interested","ringing did not pick":"ringing did not pick #Not_Picking","not willing to relocate":"not willing to relocate #Location_Constraint","not answering":"not answering #Not_Picking","called the candidate":"called the candidate #Called","not open to relocating":"not open to relocating #Location_Constraint","not a valid number":"not a valid number #Wrong_Number","number out of service":"number out of service #Wrong_Number","number switched off":"number switched off #Not_Reachable","email sent to candidate":"email sent to candidate #Mail_Sent","not picking the call":"not picking the call #Not_Picking","invalid contact number":"invalid contact number #Wrong_Number","invalid number":"invalid number #Wrong_Number","asked to call later":"asked to call later #Call_Later","location problem":"location problem #Location_Constraint","location issue":"location issue #Location_Constraint","viewed and called":"viewed and called #Called","rejected after interview":"rejected after interview #Rejected","interested in the opening":"interested in the opening #Intrested","candidate shortlisted":"candidate shortlisted #Shortlisted","candidate shortlisted for interview":"candidate shortlisted for interview #Shortlisted","candidate is interested":"candidate is interested #Interested","good communication skills":"good communication skills #Good_Communication","not fluent in english":"not fluent in english #Bad_Communication","poor grammar":"poor grammar #Bad_Communication","incoherent speech":"incoherent speech #Bad_Communication","offer made":"offer made #Offered","initial offer made":"initial offer made #Offered","candidate offered job":"candidate offered job #Offered","will not relocate":"will not relocate #Location_Constraint","does not want to relocate":"does not want to relocate #Location_Constraint","lined up for telephnoic interview":"lined up for telephnoic interview #Interview_Scheduled","lined up for interview":"lined up for interview #Interview_Scheduled","already given interview":"already given interview #Interviewed","mobile switched off":"mobile switched off #Not_Reachable","not ready to relocate":"not ready to relocate #Location_Constraint","communication skills not good":"communication skills not good #Bad_Communication","rejected cv":"rejected cv #Rejected","rejected candidate":"rejected candidate #Rejected","cv has been rejected":"cv has been rejected #Rejected","dropped a mail":"dropped a mail #Mail_Sent","interview lined up":"interview lined up #Interview_Scheduled","telephonic interview lined up":"telephonic interview lined up #Interview_Scheduled","interviewed and rejected":"interviewed and rejected #Rejected","first interview reject":"first interview reject #Rejected","final interview reject":"final interview reject #Rejected","candidate rejected after interview":"candidate rejected after interview #Rejected","not looking for change":" #Not_Looking_for_Change","not interested":" #Not_Interested","wrong number":" #Wrong_Number ","not reachable":" #Not_Reachable",duplicate:" #Duplicate_/_Already_Processed","already processed":" #Duplicate_/_Already_Processed","not picking":" #Not_Picking",called:" #Called","already interviewed":" #Interviewed","scheduled interview":" #Interview_Scheduled","mail sent":" #Mail_Sent","poor communication skills":" #Poor_Communication","call later":" #Call_Later","bad communication skills":" #Bad_Communication","currently not looking for a change":" #Not_Looking_for_Change","number not reachable":" #Nor_Reachable",shortlisted:" #Shortlisted","interview scheduled":" #Interview_Scheduled",rejected:" #Rejected","average communication skills":" #Average_Communication","location constraint":" #Location_Constraint"},s={},t=function(){n.commentsOffset=0,n.commentSetSize=10,n.isScrollInit=!1,n.isLoaded=!1,n.hf_dd_prefill=a.hiringForId?a.hiringForId:"00",n.commentCountForCompany=0,n.totalCount=0,z(),p||E(h),s=la()},u=function(a){var b=!1;a.html('<p class="title">Add comments</p>'+aa("","cvTopAdd"));var c=a.find(".commentFormCont");Y(c),W(c),y(a),c.on("focus",".textArea",function(){b||(X(c),b=!0)})},v=function(a,b){for(var c,d=b||commentList.comments;c<d.length;c++)_this_str+=fa(arr[i]);var e=d.map(function(a,b){return fa(a,"recent-list")}).join("");0==d.length?($(".withRecComment").hide(),$(".withoutRecComment").show()):($(".withRecComment").show(),$(".withoutRecComment").hide());var f="<div>"+e+"</div>";a.find(".matchParent.content").length||(x(a),y(a)),(a.find(".matchParent.content").length?a.find(".matchParent.content"):a).html(f),customScroll.init();try{a[0].csb.reset()}catch(a){}},w=function(a){var b=a,c=a.parents(".comments-list"),d=c.find(".commentTup").length;n.commentCountForCompany>d&&b.scrollTop()+b.outerHeight()>=b[0].scrollHeight&&H(a)},x=function(a){var b=a||h;b.on("click",".edit-comment",ha),b.on("click",".cancel-comment",ia),b.on("click",".delete-comment",ja),b.on("mouseenter",".commentTup",function(){$(this).find(".userActions").show()}).on("mouseleave",".commentTup",function(){$(this).find(".userActions").hide()})},y=function(a){(a||h).on("keydown",".textArea",function(){if(""==$(this).val().replace(/(\r\n|\n|\r)/g,"")&&"13"==event.which)return!1}).on("keyup",".textArea",function(a){if(a.preventDefault(),"13"==a.keyCode&&!a.shiftKey){var b=$(this);b.val(b.val().replace(/(\n)$/g,"")),b.parents(".form-row").submit()}}).on("focus",".suggest",function(a){var b=$(a.target),c=b.parents(".commentFormCont"),d=c.find(".addComm"),e=c.find(".cancel-comment");d.show(),e.show()}).on("blur",".suggest",function(a){var b=$(a.target),c=b.parents(".commentFormCont"),d=c.find(".cancel-comment"),e=c.find(".addComm"),f=$.trim(c.find(".textArea").val()),g=!1;c.hasClass("form-comment-cvtopadd")||(a.relatedTarget&&(a.relatedTarget.classList.contains("addComm")||a.relatedTarget.classList.contains("cancel-comment"))&&(g=!0),setTimeout(function(){f||g||$(".commentFormCont").hasClass("err")||(e.hide(),d.hide())},100))})},z=function(){p?requirejs(["pathStatic0_0/j/model_v5/modelWindow.amd.min"],function(a){var d=a.drawer;(0,a.modelSetup)(),d({trigger:k,routing:!1,model:h,dimens:{width:"450px"},dir:"right",open:{success:function(){$("body").css("overflow","hidden"),E()},event:"click",anim:"sideIn",minZIndex:2e3},close:{nodes:{target:h,selector:".lt_close"},success:function(){"preview"!=pageName&&(h.html(""),b=c=null,n.hf_dd_prefill="00",n.isScrollInit=!1),$("body").css("overflow",""),"activityTracker"==o&&isEditedOrDeleted&&$("#commentReload").submit()},anim:"sideOut"}})}):k.on("click",function(a){$(a.target)}),x(),y(),h.on("click","#linkNewHf",function(){window.isOnlyHFAdded=!0,hiringForLightBox(pageName,"commentBox")}),h.on("change","#commentMe",function(a){A(a.target)})},A=function(a){(j.hasClass("nScrollable")?j.find(".matchParent.content").eq(0):j).empty(),n.commentsOffset=0,H(void 0!==a?a:h)},B=function(a){return $.ajax({url:baseAPIUrl+"/resdex/v1/customTags",data:null,async:!0,type:"GET",contentType:"application/json",headers:{Accept:"application/json"},dataType:"json",beforeSend:function(a){},success:function(a,b,c){},error:function(a,b,c){var d=a.responseJSON.error,e=d.customData||"error",f=e.errorCode;switch(d.status){case 401:178!=f&&189!=f||(window.location.href=loginUrl+window.location.href);break;case 403:183==f&&(window.location.href=loginUrl+window.location.href)}},complete:function(a){}})},C=function(){B().done(function(a){var b=a;window.customTags=b,b.length>0&&(predefinedTagsList.customTags=b),D()})},D=function(a){var b=[],c=[];for(var d in predefinedTagsList)c=c.concat(predefinedTagsList[d]);var e=[];for(var f in c)-1==e.indexOf(c[f].toLowerCase())&&(b.push(c[f]),e.push(c[f].toLowerCase()));for(var g in b)sugg_hash_data.push({displayTextEn:b[g]})},E=function(a){h.html()&&h.find("#commentLayerList").length||(n.isLoaded=!1,U(),G()),j||(j=h.find("#commentLayerList")),A(a||null),n.isLoaded=!0,V(h)},F=function(a){a=a||"00",c?c.replaceData({data:s,prefillData:"a"+a}):n.hf_dd_prefill=a,k.click()},G=function(){s=la(),b=$("#comment-tag-dd").singleDD({data:g,maxHeight:69,prefillData:"0",defaultIndex:!1,changeDirection:!0,textWrap:"span",width:"144px",callBack:function(a){n.isLoaded&&A(),setDDWidth(a,"comment-tag-dd_inp","comment-tag-dd","144px")}}),c=$("#comment-hiring-dd").singleDD({data:s,maxHeight:180,prefillData:n.hf_dd_prefill,defaultIndex:!1,changeDirection:!0,textWrap:"span",sortPrefix:"a",width:"155px",callBack:function(a){n.isLoaded&&A(),setDDWidth(a,"comment-hiring-dd_inp","comment-hiring-dd","130px","a")}})},H=function(a){var b=null,c="";"preview"==pageName?c=uniqId:"activityTracker"==pageName?c=k.parent().parent().attr("data-id"):(b=srpTupleJson[$(a).parents(".tuple").attr("data-index")]||{},c=b.uniqueId);var d=I(c);d&&(n.commentsOffset+=n.commentSetSize,d.commentCountForCompany&&(n.commentCountForCompany=d.commentCountForCompany),n.totalCount=d.totalCount,da(),"srp"==o&&(!n.isLoaded&&d.comments.length<1?h.find(".bottom").hide():h.find(".bottom").show()),ea(d.comments)),j.find(".list-item").length||$(".no-comment").show()},I=function(a,b,c){var d=void 0===c||c,e=void 0;return $.ajax({url:m+"/"+a+"/comments",data:b||{start:n.commentsOffset,count:n.commentSetSize,tagsOnly:$("#comment-tag-ddHid").val(),byMe:$("#commentMe").is(":checked")?1:0,hiringForId:"00"==$("#comment-hiring-ddHid").val()?null:$("#comment-hiring-ddHid").val(),commentCountForCompany:!("00"==n.hf_dd_prefill&&!n.isLoaded)},async:!1,type:"GET",contentType:"application/json",headers:{Accept:"application/json",clientId:"desktop"},dataType:"json",beforeSend:function(a){},success:function(a,b,c){e=a,d&&($("#comErrCnt").hide(),$("#srpSticky").css("top","0"))},error:function(a,b,c){var d=a.responseJSON.error,e=d.customData||"error",f=e.errorCode;switch(d.status){case 401:178!=f&&189!=f||(window.location.href=loginUrl+window.location.href);break;case 403:183==f&&(window.location.href=loginUrl+window.location.href)}},complete:function(a){}}),e},J=function(a){var b=a,c={},d=void 0,e=void 0,f=b.find(".sugInp"),g=" "+$.trim(f.val())+" ",h=g.replace(/\r\n|\r|\n/g,"<br />").replace(/</g,"&lt;").replace(/>/g,"&gt;");formState=b.attr("data-state"),currentListItem=b.parents(".list-item");var i=void 0;if("preview"==o)d=uniqId,e=mob,i=name;else if("activitytracker"==o)d=k.parent().parent().attr("data-id"),e="";else{var j=b.closest(".tuple"),l=j.attr("data-index");d=srpTupleJson[l].uniqueId||{};var n=j.find(".tel");i=srpTupleJson[l].name,n.hasClass("telSeen")||n.hasClass("active")?(e=n.find(".tel").eq(0).text(),e=e.replace(/^\+/,"").replace("(M)","").replace("(R)","")):e=""}if(hfStateData&&(h=T(h)),!P(h,b)){var p=!1;p=new RegExp(/#|@/g).test(h);var q=h.match(/\s#([a-zA-Z0-9._#]*)/g),r=h.match(/\s@([a-zA-Z0-9._@]*)/g);h=hfStateData||"activityTracker"==pageName&&"hflp"==pageSource?K(h):h,(hfStateData||"activityTracker"==pageName&&"hflp"==pageSource)&&(h=K(h),b.find(".textArea").attr("data-powerTag","true")),h=encodeURIComponent(h);var s=m+"/"+d+"/comments",t="ADD";c.comment=h,c.SearchId=searchData.sid,c.mobileNumber=e,c.hfFlowName=hfFlowName,"activityTracker"==pageName&&(c.hiringForId=k.parent().parent().attr("data-index"));var u=!1;if("activityTracker"==pageName||"comment-add"!=formState&&"comment-cvtopadd"!=formState||hfStateData||!p||"undefined"!=typeof comment_layer_submit_elm&&$(comment_layer_submit_elm).length){if("comment-edit"==formState){u=M(currentListItem,h);var v=parseInt(currentListItem.attr("data-hfid"));c.commentId=currentListItem.attr("data-id"),c.hiringForId=isNaN(v)?null:v,t="EDIT"}u?(b.addClass("err"),b.find(".erLbl").text("You cannot change/edit one or more of these tags, but you can add comment.")):N(s,c,t,b,f.val(),currentListItem.attr("data-text"))}else comment_layer_submit_elm=b.find(".addComm").addClass("lightBoxOpened"),window.isOnlyHFAdded=!0,getRdxRequirementContent({user:i||"Candidate",tag:q?$.trim(q[0]).split("#")[1].toUpperCamelCase():null,taggedUsed:r?$.trim(r[0]).split("@")[1]:null}),addLB.options.close.success=function(){"undefined"!=typeof comment_layer_submit_elm&&$(comment_layer_submit_elm).length&&$(comment_layer_submit_elm).hasClass("lightBoxOpened")&&(comment_layer_submit_elm.removeClass("lightBoxOpened"),comment_layer_submit_elm.click(),comment_layer_submit_elm=null)}}},K=function(a){var a=a;return a.split(",").map(function(a,b){return r[$.trim(a)]?a.replace($.trim(a),r[$.trim(a)]+" "):a}).join(",")},L=function(a,b){var c=0,d="null";for(c=0;c<b.length;c++){var e=decodeURIComponent(a.toLowerCase()),f="#"+b[c].toLowerCase();if(e.match(f)){d=b[c].toLowerCase();break}}return d},M=function(a,b){var c={status:a.attr("data-status").toLowerCase(),comm:a.attr("data-comm-tag").toLowerCase(),cont:a.attr("data-cont-tag").toLowerCase()},d=predefinedTagsList.states||[];d=d.slice(0),d.push("Review_Later");var e={status:L(b,d),comm:L(b,predefinedTagsList.communication),cont:L(b,predefinedTagsList.contactibility)},f=!1;for(var g in c)if("null"==c[g]&&"null"!=e[g]||"null"!=c[g]&&"null"!=e[g]&&c[g]!=e[g]){f=!0;break}return f},N=function(a,b,c,d,e,f){var g={Accept:"application/json",clientId:"desktop"},h=decodeURIComponent(b.comment),i=d.closest(".tuple"),j=f||null;"ADD"!=c&&(g["X-HTTP-Method-Override"]="PUT"),"preview"==pageName&&$(".stickyCv").length&&RecTracking.track("cvPreviewClick",{actionType:"sticky",actionSrc:"addcomment"}),$.ajax({url:a,contentType:"application/json",headers:g,type:"POST",data:JSON.stringify(b),beforeSend:function(a){d.gLoader().block()},success:function(a,b,f){if("srp"==o||"context"===pageName||"simcv"===pageName)try{var g={actionType:"click",recruiterId:userId,companyId:companyId,hfKeyword:hfStateData?hfStateData.name:null,hfType:hfStateData&&hfStateData.id?"Selected":"created",actionSrc:"comment",searchId:searchData.sid,pageName:pageName};"context"===pageName?(g.contextUserId=srpTupleJson[i.attr("data-index")].userId,g.principalUserId=masterId):"simcv"===pageName?(g.similarUserId=srpTupleJson[i.attr("data-index")].userId,g.principalUserId=masterId):g.userIds=[srpTupleJson[i.attr("data-index")].userId],ub.track("resdexSrpClick",g)}catch(a){}if("preview"!=pageName&&"EDIT"!=c){var l=a.hiringForId;if(a.statusTag){var m=new Date;i.find(".reviewLaterTag");hfStateData.id||(hfStateData.id=l),window.review_later.markAsReviewed(i,m.getTime(),{recId:userId,tag:a.statusTag},0,!0)}}if("activityTracker"==pageName&&(isEditedOrDeleted=!0),"EDIT"==c){if(O(d,a),hfStateData&&hfStateData.id){window.cvTags.editDeleteComment(d.attr("id"),i);var n=i.attr("data-index"),p=currentListItem.find(".statusTag").hasClass("active");if(a.hiringForId==hfStateData.id&&j.toLowerCase().includes("#review_later")&&!h.toLowerCase().includes("#review_later"))p&&window.review_later.deleteReviewLater(i,!1);else if(p){var q=i.find(".reviewLaterTag");window.review_later.undoMarked(q)}var r=currentListItem.find(".statusTag");r.length&&(srpTupleJson[n].activeTag=null)}}else{"commentFormcvTopAdd"!=d.attr("name")?S(a):a.hiringForId&&!s["a"+a.hiringForId]&&(s["a"+a.hiringForId]=hfStateData?hfStateData.name:k.parent().parent().attr("hfname"));try{var t=a.customTags||[],u=getDDListObjects(),v=void 0,w=void 0;t.forEach(function(a){switch(a.type){case 1:v="interestedInDD",w="about_candidate";break;case 2:if("review_later"===a.name.toLowerCase())break;v="statusDD",w="states";break;case 4:v="contactibilityDD",w="contactibility";break;case 5:v="communicationDD",w="communication"}if(v){var b=$("#"+window.cvTags[v].config.ui.id+":first-child");ResdexEvents.dispatchEvent("ddDataReplaced",b),setTimeout(function(){window.cvTags[v].getInstance().replaceData({data:u[w],prefillData:["#"+a.name.toLowerCase()]}),showSelectedDD(b),v=null})}});e&&"#"===e.charAt(0)&&window.topBand.header.showToolTip('Success ! you have added your tag on this CV.</br>You can now organize all your activities & profiles under this requirement by going to <a href="/v2/hiringFor/list" target="_self">Resdex Requirement </a> page')}catch(a){}}"preview"==pageName&&(ka(uniqId),$("#srpSticky").removeClass("noCommTopBand")),d.find("textArea").val(""),ia(d.find(":submit")),pageName,$(".cvTopErrMsg").hide(),d.find(".counter em").text("250");var x=d.find(".textArea");if(x.attr("data-powerTag")){x.attr("data-powerTag","");try{ub.track("resdexPowerCommentTag",{actionType:"click",recruiterId:userId,companyId:companyId,pageName:pageName,commentName:h,convertedTag:{}})}catch(a){}}},error:function(a,b,c){var e=a.responseJSON.error,f=e.customData||"error",g=f.errorCode;switch(e.status){case 401:178!=g&&189!=g||(window.location.href=loginUrl+window.location.href);break;case 403:183==g?window.location.href=loginUrl+window.location.href:131==g&&$("#commentText_err").show().html(f.errorMessage?f.errorMessage:f);break;case 400:case 404:ca(d,f.errorMessage?f.errorMessage:f);break;default:ia(d.find(":submit")),ca("Due to some technical issue, your request could not be processed. Please try again in a few minutes.")}},complete:function(a){d.gLoader().unblock()}})},O=function(a,b){var c=a,d=a.parents(".commentTup");if(d.hasClass("strike-status")){d.attr("data-status")}d.replaceWith(fa(b,c.parents(".recent-comm-list").length?"recent-list":""))},P=function(a,b){var c=!1;if(hfStateData){var d=new RegExp(/\s@([a-z|A-Z])/g),e=new RegExp(/\#{2,}/g);d.test(a)?c="Please enter a valid user":e.test(a)&&(c="Please enter a valid tag"),c?(b.addClass("err"),b.find(".erLbl").text(c)):b.removeClass("err")}return c},Q=function(a){var b=h.find(".active-status[data-hfid='"+a+"']");b.removeClass("active-status"),b.find(".statusTag").removeClass("active")},R=function(a){var b="Requirement "+(hfStateData.id?'<a href="/v2/hiringFor/detail?hiringForIds='+hfStateData.id+'&type=activity&action=all_viewed" target="_self" class="hfName elps" title="'+hfStateData.name+'">'+hfStateData.name+"</a>":'<span class="hfName elps" title="'+hfStateData.name+'">'+hfStateData.name+"</span>");h.find("#hfStatusTxt").html(b)},S=function(a){a.isActive&&Q(a.hiringForId),h.find(".bottom").show();var b=[];if(b.push(a),ea(b,"ADD"),n.totalCount+=1,n.commentCountForCompany+=1,da(),"activityTracker"==pageName){if(a.statusTag){var d=k.parent().parent().find(".procDD");$(d).length&&$(d).data().singleDD.select(a.statusTag.toLowerCase())}for(var e=0;e<a.customTags.length;e++)if("2"!=a.customTags[e].type){var f=k.parent().parent().find(".tagsCol");if($(f).length){var g="";g=""==$(f).text()?a.customTags[e].name:", "+a.customTags[e].name,$(f).append(g),$(f).attr("title",$(f).text())}}}a.hiringForId&&(s["a"+a.hiringForId]||(s["a"+a.hiringForId]=hfStateData?hfStateData.name:k.parent().parent().attr("hfname"),c.replaceData({data:s,prefillData:"a"+n.hf_dd_prefill})))},T=function(a){var b=" "+a+" ";return b.replace(l,function(a,b,c,d){var e=$.trim(a).substring(1);return user_id=getKeyFromValue(userList,e)," @"+user_id})},U=function(){var a=_();h.html(a);var b=h.find(".commentFormCont");j=h.find("#commentLayerList"),Y(b),X(b),W(b)},V=function(a,b){var c={COMMENT:[".commHigh"],MENTIONS:[".commMention"],STAGETAGS:[".commState"],TAGS:[".commTag"]};if(highlighter.COMMENT&&commentSearchType.length)for(var d=0;d<commentSearchType.length;d++)!function(d){var e=b?a.hasClass(commentSearchType[d])?a:null:a.find("."+commentSearchType[d]);e&&$.each(highlighter,function(a,b){c[a]&&$.each(c[a],function(a,c){e.find(c).highlight(b.SEARCHED,{element:"em",className:"hlite",wordsOnly:!0})})})}(d)},W=function(a){var b={};b[a.find("textarea").attr("id")]={counter:a.find(".counter em")},a.find("textarea").textLimter({options:b})},X=function(a){var b;window.customTags||C();var c=a.find(".suggest");new e((b={trigger:c,url:f,category:{powercomments:""},startSearchAfter:2,appId:112,maxSuggestions:6,showRelatedConcept:!1,maxHeight:388,multiSearch:!0,onSelect:function(a,b,c){},placeholder:!1},defineProperty(b,"multiSearch",!0),defineProperty(b,"localSuggestions",{delimiter:["@","#"],appendCommaAtLast:!1,removeRepetedDelimiter:!0,data:function(a){return"@"===a?sugg_user_data:"#"===a?sugg_hash_data:void 0}}),b))},Y=function(a){var b=a.attr("name"),c=a.find(":submit").attr("id"),d=new commonValidator;d.validate({formNames:[b],errors:Z,styles:{errorClass:"err",okClass:"ok",softMandClass:"softMand",parentObjectClass:"commentFormCont",maxLevel:10},submitButton:[c],disableSubmit:!0,beforeSubmit:function(){d.isValid()&&J(a)}})},Z={5001:"This field cannot be left blank"},_=function(){var a=hfStateData?hfStateData.name:k.parent().parent().attr("hfName")?k.parent().parent().attr("hfName"):"",b=hfStateData?hfStateData.id:k.parent().parent().attr("data-index")?k.parent().parent().attr("data-index"):"";return"activityTracker"==pageName&&(a=k.parent().parent().attr("hfName"),b=k.parent().parent().attr("data-index")),'<div class="top">\n                    '+("preview"==pageName||"activityTracker"==pageName?'<div class="title"><span>Add New Comment</span><a class="iconCrossDark fr lt_close" id="closeComBox" href="javascript:"></a></div><div class="meta-txt" id="hfStatusTxt">'+(a?"Requirement "+(b?'<a href="/v2/hiringFor/detail?hiringForIds='+b+'&type=activity&action=all_viewed" target="_self" class="hfName elps" title="'+a+'">'+a+"</a>":'<span class="hfName elps" title="'+a+'">'+a+"</span>"):'<div class="msgBar blue"><div class="cnt" id="">To organize comments seamlessly <a href="#" id="linkNewHf" class="roboM">ADD REQUIREMENT</a></div> </div>'):'<div class="title"><span>Add Comment</span></div>')+"\n                    </div>\n                    "+aa("","Add")+'            \n                </div>\n                <div class="bottom">\n                    <div class="title commentCountInfo"><em id="commCount">0</em> Comments</div> \n                    <div class="nav-dd clFx ptb2 mb10">\n                        <div class="dd-cont chk noMargin">\n                            <p class="meta-txt">All</p>                            \n                            <div class="singleDD dispInB " id="comment-tag-dd">\n                               <div class="dWrap">\n                                  <input class="sdTxt noAutoScroll" id="comment-tag-dd_inp" type="text" name="" value="" readonly/>\n                                  <span class="smArw"></span>\n                               </div>\n                            </div>\n                        </div>\n                        <div class="dd-cont chk noMargin">\n                            <p class="meta-txt">Requirement</p>                            \n                            <div class="singleDD dispInB " id="comment-hiring-dd">\n                               <div class="dWrap">\n                                  <input class="sdTxt noAutoScroll" id="comment-hiring-dd_inp" type="text" name="" value="" readonly/>\n                                  <span class="smArw"></span>\n                               </div>\n                            </div>\n                        </div>\n                         <div class="chkZ fr noMargin">    \n                           <input type="checkbox" name="checkbox" value="" id="commentMe">      \n                           <label for="commentMe">    \n                           <span></span> <em class="meta-txt">by Me</em>  \n                           </label> \n                        </div>          \n                    </div>\n                    <div class="no-comment">\n                        <em class="iconComm"></em>\n                        <p>No Comment</p>\n                        <p class="mt10">Be the first one to add a comment</p>\n                    </div>\n                    <div class="comments-list nScroll" id="commentLayerList">                       \n                    </div>\n\n                </div>'},aa=function(a,b){var c=a||"";c=$.trim(c).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/<br\s*[\/]?>/gi,"\n");var d=b,e=a?"comment-edit":"comment-"+b.toLowerCase();return'<form class="form-row commentFormCont wrap form-'+e+'" data-state="'+e+'" id="commentForm" name="commentForm'+d+'" action="">\n                        <div class="suggestCont">\n                            <div class="suggest" id="suggestId'+d+'">\n                                <div class="sWrap">\n                                    <div class="inpWrap">\n                                    <textarea type="text" name="commentText" rel="required:5001" maxlength="250" id="textArea'+d+'" autocomplete="off" class="sugInp textArea" placeholder="Add Your Comment" maxlength="250">'+c+"</textarea>\n                                    </div>\n                                </div>\n                            </div>\n                        "+("preview"==pageName||"activityTracker"==pageName?'</div>\n                        <i class="erLbl" id="commentText_err"></i>\n                        <div class="msgContainer clFx">\n                            <div class="counter fr"><em class="commentCounter'+d+'"></em> Characters</div>\n                            <div class="meta-txt dark">Use # to insert tags or @ to notify a team member</div>\n                        </div>':'<div class="counter"><em class="commentCounter'+d+'"></em> Characters</div>\n                        </div>\n                        <div class="meta-txt dark">Use # to insert tags <br/>or @ to notify a team member</div>\n                        <i class="erLbl" id="commentText_err"></i><div class="hfContainer"><div id="tagDDContainer" class="hiringForContainer"></div></div>')+"\n                        "+ba(d)+"\n                    </form>"},ba=function(a){var b="Add"==a?"ADD COMMENT":"SAVE COMMENT",c='<button class="btn btn-primary addComm" id="submitComm'+a+'" type="submit">'+b+"</button>";return"Add"!=a&&(c+='<a href="javascript:" class="btn btn-link cancel-comment">Cancel</a>'),c},ca=function(a,b){a.addClass("err"),a.find(".erLbl").text(b)},da=function(a){if(c){var d="00"==c.hidElm.val()&&"0"==b.hidElm.val()&&!$("#commentMe").is(":checked"),e=d?""+n.commentCountForCompany:n.totalCount+"/"+n.commentCountForCompany;h.find("#commCount").html(e)}$(".commentCont.open").closest(".tuple").find(".commentsLink").text(n.commentCountForCompany>0?n.commentCountForCompany:""),"DELETE"==a&&"preview"==pageName||$("#add_comment").find("em").text("("+(n.commentCountForCompany>0?n.commentCountForCompany:"0")+")")},ea=function(a,b){var c=0,d="",e=j.hasClass("nScrollable")?j.find(".matchParent.content").eq(0):j;for(h.find(".nav-dd").show(),h.find(".no-comment").hide(),c;c<a.length;c++)d+=fa(a[c]);b&&"ADD"==b?(e.prepend($(d)),V($(d),"direct")):e.append(d),customScroll.init();try{j[0].csb.reset()}catch(a){}if(!n.isScrollInit){j.find(".content").bind("scroll",function(a){var b=$(a.target);w(b)}),n.isScrollInit=!0}},fa=function(a,b,c){var d=(a.mentions,a.comment),e=(a.customTags,a.customTags),f=cont_tag=null;for(var g in e){var h=e[g];switch(h.type){case 4:cont_tag=h.name;break;case 5:f=h.name}}var i=d=d.replace(/&amp;/g,"&").replace(/(&lt;br\s*\/?&gt;)/g,"<br>");d=d.replace(/,/g,""),comment_str_processed_more=d.length,a.hiringForId&&(d=d.replace(l,function(a,b,c,d){return" <span class='userName commMention' title=\""+a+'">@'+a.split("@")[1]+"</span>"
}).replace(/\s#([A-Za-z0-9_\-\/]+)/g,function(b){var c=$.trim(b).substring(1),d=c.replace(/_/g," ");return a.statusTag&&c.toLowerCase()==a.statusTag.toLowerCase()?" <span class='tag "+(a.isActive?"commState":"")+" statusTag"+(a.isActive?" active":"")+"' title=\""+d+'">'+d+"</span>":" <span class='tag commTag' title=\""+d+'">'+d+"</span>"}));var j=rpProfileUrl+"1rp"+a.rdxUserId+"_small4",k=a.rdxUserId==userId?"You":a.rdxUserName,m=a.hiringForId?s["a"+a.hiringForId]?s["a"+a.hiringForId]:hfStateData&&hfStateData.id&&hfStateData.id==a.hiringForId?hfStateData.name:"":"",n=a.commentDateTime;return b&&"recent-list"==b&&(n=n.match(/(.*?\s){3}/g)[0]),'<div class="list-item commentTup '+("You"==k?"comment-my":"comment-others")+" "+(a.isActive?"active-status":"strike-status")+'" data-id="'+a.commentId+'" data-hfId="'+a.hiringForId+'" data-text="'+i.replace(/"/g,"&quot;").replace(/'/g,"&#39;")+'" data-status="'+a.statusTag+'" data-cont-tag="'+cont_tag+'" data-comm-tag="'+f+'">\n                <div class="left-sec">\n                    <img src="'+j+'" title="" width="40" height="40" border="0">\n                </div>\n                <div class="right-sec">\n                        <div class="comm-text-div mb5 '+(a.rdxUserId==userId?"comment-with-action":"")+'">\n                            '+(a.rdxUserId==userId?ga():"")+'\n                            <div class="comm-text commHigh">'+d+'</div>\n                        </div>\n                    <div class="f11">\n                        <div class="meta fl">\n                            <span class="user elps" title="'+k+'">'+k+"</span> \n                            "+(a.hiringForId?'<em> commented for </em> <em class="elps" title="'+m+'">'+m+"</em>":"")+'\n                        </div>\n                        <div class="date fr">'+n+"</div>\n                    </div>\n                </div>\n            </div>"},ga=function(){return"<span class='userActions' style=\"display:none;\">\n                    <a href='javascript:void(0)' class='edit-comment pencilIcon'></a>\n                    <a href='javascript:void(0)' class='delete-comment iconDel'></a>\n                </span>"},ha=function(a){var b=$(a.target),c=b.parents(".list-item"),d=c.attr("data-text"),e=c.attr("data-id"),f=aa(d,"Edit"+e);c.find(".right-sec").hide(),c.append(f);var g=c.find("form");Y(g),X(g),W(g),g.find("textarea").focus(),g.find("textarea").data("updateCounter")()},ia=function(a){var b=$(a.target).length?$(a.target):a,c=b.closest(".list-item");c.find(".right-sec").show(),c.find(".commentFormCont").remove()},ja=function(a){var b=$(a.target).closest(".list-item"),c=b.find(".statusTag"),d=b.find(".statusTag").hasClass("active"),e=b.attr("data-id"),f=void 0,g=(b.attr("data-hfid"),$(a.target).parents(".tuple")),h=b.attr("data-text"),i=void 0;"preview"==o?f=uniqId:"activitytracker"==o?f=k.parent().parent().attr("data-id"):(i=srpTupleJson[$(a.target).parents(".tuple").attr("data-index")]||{},f=i.uniqueId),$.ajax({url:m+"/"+f+"/comments/"+e,data:{hfFlowName:hfFlowName,sid:"undefined"!=typeof sid?sid:searchData.sid},method:"POST",contentType:"application/json",headers:{Accept:"application/json",clientId:"desktop","X-HTTP-Method-Override":"Delete"},beforeSend:function(){b.gLoader().block()},success:function(a,e,i){if("204"==i.status){b.remove();var k=g.attr("data-index");if(h.toLowerCase().includes("#review_later")&&b.attr("data-hfid")==hfStateData.id)d&&window.review_later.deleteReviewLater(g,!1);else if(d){var l=g.find(".reviewLaterTag");window.review_later.undoMarked(l)}c.length&&(srpTupleJson[k].activeTag=null),n.totalCount=n.totalCount-1,n.commentCountForCompany=n.commentCountForCompany-1,da("DELETE");try{j.find(".list-item").length||$(".no-comment").show()}catch(a){}"activityTracker"!=pageName||"activityTracker"==pageName&&(isEditedOrDeleted=!0),"preview"==pageName&&ka(f)}hfStateData&&hfStateData.id&&window.cvTags.editDeleteComment(b.attr("id"),g)},error:function(a,b,c){var d=a.responseJSON.error,e=d.customData||"error",f=e.errorCode;switch(d.status){case 401:178!=f&&189!=f||(window.location.href=loginUrl+window.location.href);break;case 403:183==f&&(window.location.href=loginUrl+window.location.href)}},complete:function(){b.gLoader().unblock()}})},ka=function(a,b){var c={start:0,count:5,tagsOnly:0,byMe:0,hiringForId:null,commentCountForCompany:!0},d=I(a,c,b?b.hideMsg:null);v($("#showRecentCommList"),d.comments),updateReadAllCount(d.commentCountForCompany)},la=function(){var a={a00:"All"};return $.each(q,function(b,c){var d=q[b];a["a"+d.id]=d.name}),a};return{init:t,processCommentInList:ea,updateHfName:R,showCommentInList:fa,openCommentLayerHiringFor:F,get_hiringForList:la,setFilterDD:G,replaceUserNameToId:T,processCustomTags:C,initiateCVRecentCommentList:v,getCommentForm:aa,formActionCVTopBand:u,getFormActions:ba,updateRecentList:ka,updateHiringForList:function(a,b){s["a"+a]||(s["a"+a]=b)},replacePowerCommentsMapping:K,getCurrentStatusTag:L,checkCommentState:M}};window.cv_comments_layer={},$(window).on("load",function(){isEditedOrDeleted=!1,"preview"==pageName&&($("#cvRecentComment").html('<div class="withoutRecComment"><em class="iconComm"></em><p>No Comment/Tag is added yet</p></div><div class ="withRecComment"><p class="title fl" id="recentCommCount"><span class="count">'+(commentsCount>5?5:commentsCount)+'</span> Recent Comments</p><a href="javascript:" class="btn-link fr roboM '+(commentsCount>5?"":"dispN")+'" id="openCommLayer">Read all <span class="count">'+commentsCount+'</span> Comments</a><div class="comments-list nScroll clFx" id="showRecentCommList"></div></div>'),$(".stickyCv").length&&commentsCount>0&&($("#openCommLayer").show(),$(".withRecComment").show()),cv_comments_layer=commentsLayer({comment_layer_div:$("#cvCommentLayer"),layer_click_btn:$("#openCommLayer")}),cv_comments_layer.init(),cv_comments_layer.initiateCVRecentCommentList($("#showRecentCommList")),cv_comments_layer.formActionCVTopBand($("#cvTopAddCommentForm")))});